syntax = "proto3";

package tradingbot.execution.portfolio;

// Portfolio service exposes portfolio state and trade history to API Gateway / other services.
service Portfolio {
  // GetPortfolio returns the current portfolio snapshot and recent trades for a given account.
  rpc GetPortfolio(GetPortfolioRequest) returns (GetPortfolioResponse);
}

// Enum for trade side
enum Side {
  SIDE_UNSPECIFIED = 0;
  BUY = 1;
  SELL = 2;
}

// Trade represents an executed trade or fill.
message Trade {
  string id = 1;           // trade id
  string symbol = 2;       // e.g. BTC-USD
  Side side = 3;
  double price = 4;
  double quantity = 5;
  int64 timestamp = 6;     // unix epoch milliseconds
  string exchange = 7;     // optional exchange identifier
}

// Position represents an open position in the portfolio.
message Position {
  string symbol = 1;
  double quantity = 2;     // positive for net long, negative for net short
  double avg_price = 3;    // average entry price
  double unrealized_pnl = 4;
}

// Portfolio summary contains overall account metrics.
message PortfolioSummary {
  double total_balance = 1;
  double available_balance = 2;
  double pnl = 3;
}

// Request for portfolio retrieval
message GetPortfolioRequest {
  // Account or portfolio id; empty means default account for the caller.
  string account_id = 1;
  // Optional: how many recent trades to include
  int32 recent_trades_limit = 2;
}

// Response containing portfolio state and recent trades
message GetPortfolioResponse {
  PortfolioSummary summary = 1;
  repeated Position positions = 2;
  repeated Trade recent_trades = 3;
}
